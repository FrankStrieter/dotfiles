#!/usr/bin/env bash

set -euo pipefail

script="${0##*/}"
script_path="${0%/*}"

local_music="$HOME/Music/Music/"
droid_music="/sdcard/Music"
droid_host=172.16.0.15
droid_port=2222

rsync --progress \
      --verbose \
      --human-readable \
      --archive \
      --partial \
      --delete \
      --delete-excluded \
      --exclude-from "$script_path/$script.exclude" \
      --rsh "ssh -p \"$droid_port\"" \
      "$local_music" \
      "$droid_host:$droid_music"

scp -P "$droid_port" \
    "$script_path/android-sync.dir-dates" \
    "$droid_host":"$droid_music"

ssh -p "$droid_port" \
    "$droid_host" \
    bash "$droid_music/android-sync.dir-dates" "$droid_music"
