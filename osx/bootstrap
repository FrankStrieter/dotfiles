if [[ ! "$OSTYPE" == 'mac' ]]; then
  return
fi

# Install homebrew unless it is.
if ! command -v brew > /dev/null; then
  echo Installing homebrew...
  sudo -v
  yes '' | ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

# Install cask unless it is.
if ! brew cask > /dev/null 2>&1; then
  echo Installing homebrew cask...
  sudo -v
  brew install caskroom/cask/brew-cask
fi

brew tap homebrew/completions

# Run brew tap homebrew/dupes in order to be able to install below utilities.
brew tap homebrew/dupes

# Install additional utilities.
# Bash 3 that comes by default with Mac OS X does not have associative arrays,
# so we roll our own.
utils_bash=
utils_binutils=
utils_brew_cask_completion=
utils_coreutils=
utils_diffutils=
utils_file_formula=
utils_findutils=--with-default-names
utils_gawk=
utils_git=
utils_gnu_getopt=
utils_gnu_indent=--with-default-names
utils_gnu_sed=-with-default-names
utils_gnu_tar=--with-default-names
utils_gnu_which=--with-default-names
utils_gnutls=
utils_gpatch=
utils_grep=--with-default-names
utils_gzip=
utils_less=
# Requires XCode:
# utils_macvim='--override-system-vim --custom-system-icons'
utils_make=
utils_openssh=
utils_rsync=
utils_screen=
utils_unzip=
utils_vim=--override-system-vi
utils_watch=
utils_wget=
utils_zsh=

# No quotes, perform word-splitting on variable name list.
for name in ${!utils_*}; do
  key="${name#*_}"
  key="${key//_/-}"
  if ! brew list "$key" > /dev/null 2>&1; then
    args="${!name}"
    echo Installing $key $args...
    brew install $key $args
  fi
done
